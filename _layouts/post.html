{%- assign time_estimated = content | number_of_words | divided_by: 300 | plus: 1 | append: " minutes" -%}
<!doctype html>
<head>
  <title>{{ page.title | escape }} &#8211; {{ site.title | escape }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="/assets/rougify-style-github.css" />
  <link rel="stylesheet" href="/assets/article.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <header id="site-header">
    <section class="container-fluid">
      <nav class="fs-e4 pt-2 pb-3 pt-md-4">
        <div class="mb-3">
          <!-- <a href="/" style="background-size:0"><img alt="logo" src="/assets/Logo.svg" style="width:42px;height:42px;transform:rotate(15deg);"></a> -->
          <a class="text-decoration-none" href="/">{{ site.title | escape }}</a>
          <span class="serif text-muted">&mdash;</span> 
          <span class="serif text-muted">{{ site.subtitle | escape }}</span> 
        </div>
        <div>
          <a class="text-decoration-none text-nowrap" href="/feed.xml"><i class="bi-rss"></i> RSS</a>
          <a target="_blank" class="text-decoration-none text-nowrap ms-3" href="https://eepurl.com/c07Ft1"><i class="bi-envelope"></i> Get emails</a>  
          <!--<span class="serif text-muted d-none d-md-inline ms-3">(monthlyish updates)</span>-->
        </div>
      </nav>
    </section>
  </header>
  <header>
    <section class="container-fluid pt-5">
      <div class="float-start col-md-8 pe-2">
        <h1>{{ page.title | escape }}</h1>
        <p>By {{ page.author }}</p>  <!-- HAVE A SITE DEFAULT  -->      
        <p>{{ page.time | default: time_estimated }}</p>
      </div>
      <aside class="margin-note mb-5">
        <p>
{%- for tag in page.tags -%}
          <a href="/posts-by-tag#{{ tag | slugify }}">#{{ tag }}</a>
{%- endfor -%}
        </p>
        <p class="mb-0">
          {{ page.date | date: "%Y-%m-%d" }}: Published
{%- for update in page.updates -%}
          <br>{{ update.date | date: "%Y-%m-%d" }}: {{ update.changes | escape }}
{%- endfor -%}
        </p>
      </aside>
      <div class="clearfix"></div>

    </section>
  </header>

  <article class="container-fluid">
    <div class="clearfix"></div><!-- This helps if the first item in the article is a margin note -->
{{ content }}
{%- assign page_basename = page.path | remove: ".md" | remove: ".html" | remove: "_posts/" -%}
{%- assign related_heros = site.static_files | where: "basename", page_basename -%}
{%- for static_file in related_heros -%}
    <a href="{{ static_file.path }}">
      <img src="{{ static_file.path }}" style="max-width:25%">
    </a>
{%- endfor -%}

    <p>&#9639;</p>  
    <h2>Comments</h2>
    <p>Discuss and share this topic anywhere. May we recommend:</p>
    <ul>
{%- for comment in page.comments -%}
      <li>
        <a target="_blank" href="{{ comment.link }}">
          <figure>
          <blockquote>
            <p>{{ comment.text | newline_to_br }}</p>
          </blockquote>
          <figcaption class="blockquote-footer">
              {{ comment.name }} <cite title="Source Title">{{ comment.date }}</cite>
          </figcaption>
        </figure> 
      </a>
    </li>
{%- endfor -%}
{%- unless page.comments -%}
      <li>There is no official Twitter thread yet. Hit me up and I will make one.</li>
{%- endunless -%}
      <li>Please let me know any other good media coverage I should link here.</li>
    </ul>
  </article>

  <footer class="mt-5 pt-5 pb-3">
    <div class="container-fluid">
      <p>&copy; 2004&ndash;{{ "now" | date: "%Y" }} authors as noted.</p>
      <p>No cookies. No analytics. To let me know you are reading this, <a target="_blank" href="https://eepurl.com/c07Ft1">get emails</a> or interact on each article's official Twitter thread.</p>
      <p><a href="/mission">Mission</a></p>
      <p><a href="/ethics">Ethics statement</a></p>
    </div>
  </footer>

<!-- TODO: Use Jekyll to find ```mermaid and inject this js only if needed -->
<!-- https://github.com/mermaid-js/mermaid/issues/772#issuecomment-449553808 -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@8.13.8/dist/mermaid.min.js" integrity="sha256-QmSAc2kIaUjleIJ46X7qPW2zrpCbXlMz3YIGgWpQ1Jo=" crossorigin="anonymous"></script>
  <script>
    var config = {
      theme: 'forest',
      themeCSS: "* {font-family: Gill Sans,Gill Sans MT,Calibri,sans-serif}",
      flowchart:{
        useMaxWidth:false,
        htmlLabels:true
      },
      fontFamily: 'Gill Sans'
      // todo, use the article font here, how to do it? https://mermaid-js.github.io/mermaid/#/./usage
    };
    mermaid.initialize(config);
    window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid'));
  </script>   
</body>